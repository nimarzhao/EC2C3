\chapter{Regression Theory}
    \section{Matching and Regression}
    \section{Bivariate Regression}
    \section{Multivariate Regression}
        \subsection{Regression anatomy}

        \subsection{Omitted Variable Bias (OVB)}
            Consider the regression model:
            \begin{align}
                y_i = \beta_0 +\beta_1x_{1,i} +\beta_2 x_{2,i} + u_i 
            \end{align}
            and the `short' model that omits $x_{2,i}$,
            \begin{align}
                y_i = \beta_0^{(s)} +\beta_1^{(s)} x_{1,i} + u_i^{(s)}
            \end{align}
            As applied econometricians, we want to know the difference between the `short' and `long' slope estimates of $x_1$. This could often occur if we forget to control for any confounders, and as the section name implies, it turns out to create bias.
            
            \begin{theorem}[OVB]
                Omitted Variable Bias (OVB) is the bias that results from omitting a relevant covariate when estimating a regression model; the bias can be shown to equal
                \begin{align}
                    \underbrace{\beta_1^{(s)}}_\text{short est.}= \underbrace{\beta_1}_\text{actual} + \underbrace{\beta_2 \pi_1}_\text{OVB}
                \end{align}
                where $\pi_1$ is the coefficient on $x_1$ in the auxiliary regression
                \begin{align}
                    x_{2,i} = \pi_0 + \pi_1 x_{1,i} + r_{2,i}
                \end{align}
            \end{theorem}
            \begin{proof}
                Substitute the auxiliary regression into the long regression:
                \begin{align}
                    y_i
                    &= \beta_0 +\beta_1 x_{1,i} +\beta_2 (\pi_0 + \pi_1 x_{1,i} + r_{2,i})+ u_i \\
                    &= \underbrace{(\beta_1 + \beta_2\pi_0)}_\text{intercept} +  \underbrace{(\beta_1+\beta_2 \pi_1)}_\text{slope}x_{1,i} + \underbrace{(\beta_2r_{2,i}+u_i)}_\text{error}
                \end{align}
                Drawing parallels to the short regression yields the result.
            \end{proof}
            
            If we perform a short regression, all the effects from $x_1$, including the effects that go through $x_2$, are included in the short estimate. However, this is not the real effect â€“ the lower green arrows should be attributed to the missing variable $x_2$ as shown below in fig.A. Fpr the same reason, note if $x_1$ and $x_2$ are not correlated, there is no OVB.
            \begin{figure}[h]
                \centering
                \input{figures/ovb}
                \caption{Mechanism of OVB}
                \label{fig:regression/ovb}
            \end{figure}
            
            The possible slope signs and whether the short regression over or under estimates the true slope are summarised in Table \ref{tab:regression/ovb}.
            
            \begin{table}[h]
                \centering
\begin{tabularx}{\textwidth}{@{\extracolsep{\fill}}>{\centering\arraybackslash}X >{\centering\arraybackslash}X >{\centering\arraybackslash}X}
\toprule
$\beta_2$ - effect of missing var. on outcome, $y$ & $\pi_1$ - effect of estimated var. on missing var. & OVB := $\beta_2 \pi_1$ \\
\midrule
\textcolor{ForestGreen}{\textbf{+}} & \textcolor{ForestGreen}{\textbf{+}} & \textcolor{BurntOrange}{\textbf{overestimate}} \\
\addlinespace
\textcolor{ForestGreen}{\textbf{+}} & \textcolor{red}{\textbf{--}} & \textcolor{CornflowerBlue!85}{\textbf{underestimate}} \\
\addlinespace
\textcolor{red}{\textbf{--}} & \textcolor{ForestGreen}{\textbf{+}} & \textcolor{CornflowerBlue!85}{\textbf{underestimate}} \\
\addlinespace
\textcolor{red}{\textbf{--}} & \textcolor{red}{\textbf{--}} & \textcolor{BurntOrange}{\textbf{overestimate}} \\
\bottomrule
\end{tabularx}
                \caption{Over or under-estimated?}
                \label{tab:regression/ovb}
            \end{table}
            
    \section{Estimation}